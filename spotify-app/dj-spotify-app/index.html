<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <link rel="stylesheet" href="css/style.css" />
      <title>DJing Playlist App</title>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
      <script src="https://sdk.scdn.co/spotify-player.js"></script>
      <script defer src="src/script.ts" type="module"></script>

      <script>
        function displayProfile(){  
          var x = document.getElementById('profile');
        if (x.style.display == 'none') {
            x.style.display = 'block';
        } else {
            x.style.display = 'none';
        }}
      </script>
  </head>

  <body>
    <nl>
    <div>
      <section>
        <input id="clickMe" type="button" value="Display Profile" onclick="displayProfile()" />
      </section>
    </div>

    <section id="inputUser">
      <form>
        <label for="addUser">User ID:</label><br>
        <input type="text" id="addUser" name="addUser" value="fbx2u2h4kefo9xlhuhkej4bkx"><br>
        <input id="submitUser" type="button" value="Submit">
      </form>
      <p id="result"></p>
    </section>

    <section id="profile">
      <h1>Spotify profile data</h1>
      <h2>Logged in as <span id="displayName"></span></h2>
      <img id="avatar" width="500" src="#" />
      <ul>
        <li>User ID: <span id="id"></span></li>
        <li>Country: <span id="country"></span></li>
        <li>Email: <span id="email"></span></li>
        <li>Spotify URI: <a id="uri" href="#"></a></li>
        <li>Link: <a id="url" href="#"></a></li>
        <li>Profile Image: <span id="imgUrl"></span></li>
      </ul>
    </section>

    <section id="playback">
      <h1>Spotify Player</h1>
      <button id="previousSongButton">Back To Previous Track</button>
      <button id="togglePlay">Play/Pause Tracks</button>
      <button id="skipSongButton">Skip To Next Track</button>
      <script>
        window.onSpotifyWebPlaybackSDKReady = () => {
            const token = "BQBV78uqVV51WsQy4LUU0U_U_uCd7tfqj2lKRHiazGuhTX-T-Y0v5huHyEYriWG3oxrxiU4KalLr4DCDnWsc48_j8ViJ2NK9DzDEkSWu33gkuUMhoPh8CyGVrSGtCqed27zw5kALiixJ6jnar1W47zgGZn7EADlwHHmq9-nBlj1cl05i2hDjJFWdQPDs-PlJb-74qy_RrjnNVw";
            const player = new Spotify.Player({
                name: 'Web Playback',
                getOAuthToken: cb => { cb(token); },
                volume: 0.5
            });

            // Ready
            player.addListener('ready', ({ device_id }) => {
                console.log('Ready with Device ID', device_id);
            });

            // Not Ready
            player.addListener('not_ready', ({ device_id }) => {
                console.log('Device ID has gone offline', device_id);
            });

            player.addListener('initialization_error', ({ message }) => {
                console.error(message);
            });

            player.addListener('authentication_error', ({ message }) => {
                console.error(message);
            });

            player.addListener('account_error', ({ message }) => {
                console.error(message);
            });

            document.getElementById('togglePlay').onclick = function() {
              player.togglePlay();
            };

            player.connect();

            document.getElementById('skipSongButton').onclick = function() {
              player.nextTrack();
            };

            document.getElementById('previousSongButton').onclick = function() {
              player.previousTrack();
            };
        }
      </script>
    </section>
    
    <section id="playlists">
      <h1>User Playlists</h1>
      <ul> 
        <li>Playlists Total: <span id="playlists_total"></span></li>
      </ul>
        <table>
          <tr><th></th>Playlists Names:</th></tr>
          <tbody id="playlists_names"></tbody>
        </table>
    </section>
  
    <section id="inputPlaylist">
      <form>
        <label for="addPlaylist">Playlist ID:</label><br>
        <input type="text" id="addPlaylist" name="addPlaylist" value="59XMuGvjGqOINdEGGos9NZ"><br>
        <input id="submitPlaylist" type="button" value="Submit">
      </form>
      <p id="result"></p>
    </section>

    <section id="playlist">
      <h1>Spotify Playlist</h1>

      <input id="createPlaylist" type="button" value="Create New Playlist">

      <div id="playlistsGridContainer" style="height: 400px" class="ag-theme-alpine-dark"></div>

      <div class="grid-container">
        <!-- Playlist Grid 1 -->
        <div id="playlistGrid_37i9dQZF1DX4xuWVBs4FgJ" style="height: 400px" class="playlist-grid ag-theme-alpine-dark"></div>
        <!-- Playlist Grid 2 -->
        <div id="playlistGrid_59XMuGvjGqOINdEGGos9NZ" style="height: 400px" class="playlist-grid ag-theme-alpine-dark"></div>
      </div>
    </section>
  </body>
</html>